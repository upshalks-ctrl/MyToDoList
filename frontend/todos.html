<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>待办事项列表</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Font Awesome 图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <div class="top-bar">
        <div class="logo">Todo List</div>
        <div class="nav-actions">
            <!-- 消息提醒 -->
            <div class="message-notification" id="message-notification">
                <i class="fas fa-bell"></i>
                <span class="notification-count" id="notification-count">0</span>
            </div>
        </div>
        <div class="user-info">
            <span class="user-name" id="user-name">加载中...</span>
            <button id="logout-btn">退出登录</button>
        </div>
    </div>

    <!-- 消息面板 -->
    <div id="message-panel" class="message-panel">
        <div class="message-panel-header">
            <h3>任务提醒</h3>
            <button class="message-panel-close" onclick="closeMessagePanel()">&times;</button>
        </div>
        <div class="message-panel-content" id="message-panel-content">
            <div class="no-messages">暂无提醒消息</div>
        </div>
    </div>

    <!-- 任务详情模态框 -->
    <div id="task-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>任务详情</h3>
                <button class="modal-close" onclick="closeTaskDetailModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="task-detail-item">
                    <label>任务标题:</label>
                    <p id="detail-title"></p>
                </div>
                <div class="task-detail-item">
                    <label>任务描述:</label>
                    <p id="detail-description"></p>
                </div>
                <div class="task-detail-item">
                    <label>截止时间:</label>
                    <p id="detail-due-date"></p>
                </div>
                <div class="task-detail-item">
                    <label>优先级:</label>
                    <p id="detail-priority"></p>
                </div>
                <div class="task-detail-item">
                    <label>创建时间:</label>
                    <p id="detail-created-at"></p>
                </div>
                <div class="task-detail-item">
                    <label>标签:</label>
                    <div id="task-detail-tags"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 主内容区域 -->
    <div class="main-content">
        <!-- 左侧导航栏 -->
        <div class="sidebar">
            <!-- 主要导航 -->
            <div class="nav-section">
                <div class="nav-section-title">主要功能</div>
                <a href="#" class="nav-item active" data-view="add-task">
                    <i class="fas fa-plus"></i> 添加任务
                </a>
                <a href="#" class="nav-item" data-view="search">
                    <i class="fas fa-search"></i> 搜索
                </a>
                <a href="#" class="nav-item" data-view="today">
                    <i class="fas fa-calendar-day"></i> 今天待办事项
                </a>
                <a href="#" class="nav-item" data-view="preview">
                    <i class="fas fa-chart-pie"></i> 预览
                </a>
                <a href="#" class="nav-item" data-view="filter">
                    <i class="fas fa-filter"></i> 过滤器
                </a>
            </div>

            <!-- 我的项目 -->
            <div class="nav-section">
                <div class="nav-section-title">我的项目</div>
                <div class="tag-list" id="tag-list">
                </div>
            </div>
        </div>

        <!-- 消息提示区域 -->
        <div id="message" class="message"></div>
        
        <!-- 右侧内容区域 -->
        <div class="content-area">
            <!-- 添加任务视图 -->
            <div class="view" id="add-task-view">
                <h2>添加新任务</h2>
                <form class="add-task-form" id="task-form">
                    <div class="form-group">
                        <label for="task-title">任务标题 <span style="color: red;">*</span></label>
                        <input type="text" id="task-title" name="title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="task-description">任务描述</label>
                        <textarea id="task-description" name="description"></textarea>
                    </div>
                    
                    <div class="form-row">
            <div class="form-group half">
                <label for="task-due-date">截止时间 <span style="color: red;">*</span></label>
                <input type="datetime-local" id="task-due-date" name="due_date" required>
            </div>
                        
                        <div class="form-group half">
                            <label for="task-priority">优先级</label>
                            <select id="task-priority" name="priority">
                                <option value="1">低</option>
                                <option value="2" selected>中</option>
                                <option value="3">高</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>标签</label>
                        <div class="tag-selector" id="tag-selector">
                            <!-- 标签选项将通过JavaScript动态生成 -->
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">添加任务</button>
            </form>
        </div>

        <!-- 修改任务弹框 -->
        <div id="edit-task-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>修改任务</h3>
                    <span class="close" id="edit-modal-close">&times;</span>
                </div>
                <form class="edit-task-form" id="edit-task-form">
                    <input type="hidden" id="edit-task-id" name="id">
                    
                    <div class="form-group">
                        <label for="edit-task-title">任务标题 <span style="color: red;">*</span></label>
                        <input type="text" id="edit-task-title" name="title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-task-description">任务描述</label>
                        <textarea id="edit-task-description" name="description"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="edit-task-due-date">截止时间 <span style="color: red;">*</span></label>
                            <input type="datetime-local" id="edit-task-due-date" name="due_date" required>
                        </div>
                        
                        <div class="form-group half">
                            <label for="edit-task-priority">优先级</label>
                            <select id="edit-task-priority" name="priority">
                                <option value="1">低</option>
                                <option value="2" selected>中</option>
                                <option value="3">高</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>标签</label>
                        <div class="tag-selector" id="edit-tag-selector">
                            <!-- 标签选项将通过JavaScript动态生成 -->
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancel-edit">取消</button>
                        <button type="submit" class="btn btn-primary">保存修改</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- 搜索视图 -->
            <div class="view" id="search-view" style="display: none;">
                <h2>搜索任务</h2>
                <div class="search-filter">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="搜索任务...">
                        <i class="fas fa-search"></i>
                    </div>
                </div>
                <div class="task-list" id="search-results">
                    <!-- 搜索结果将通过JavaScript动态生成 -->
                </div>
            </div>

            <!-- 今天待办事项视图 -->
            <div class="view" id="today-view" style="display: none;">
                <h2>今天待办事项</h2>
                <div class="task-list" id="today-tasks">
                    <!-- 今天的任务将通过JavaScript动态生成 -->
                </div>
            </div>

            <!-- 预览视图 -->
            <div class="view" id="preview-view" style="display: none;">
                <h2>任务日历</h2>
                <div class="week-calendar">
                    <div class="calendar-controls">
                        <div class="date-picker-container">
                            <label for="start-date">选择起始日期:</label>
                            <input type="date" id="start-date" name="start-date">
                            <button id="refresh-calendar">刷新</button>
                        </div>
                    </div>
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- 日期表格将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>

            <!-- 过滤器视图 -->
            <div class="view" id="filter-view" style="display: none;">
                <h2>任务过滤器</h2>
                <div class="search-filter">
                    <div class="filter-group">
                        <select id="filter-completed">
                            <option value="">状态</option>
                            <option value="true">已完成</option>
                            <option value="false">未完成</option>
                        </select>
                        <select id="filter-priority">
                            <option value="">优先级</option>
                            <option value="1">低</option>
                            <option value="2">中</option>
                            <option value="3">高</option>
                        </select>
                        <select id="filter-tag">
                            <option value="">标签</option>
                            <!-- 标签选项将通过JavaScript动态生成 -->
                        </select>
                        <select id="filter-sort-by">
                            <option value="">排序方式</option>
                            <option value="priority">优先级</option>
                            <option value="due_date">截止时间</option>
                            <option value="tags">标签</option>
                        </select>
                        <select id="filter-sort-order">
                            <option value="asc">升序</option>
                            <option value="desc">降序</option>
                        </select>
                    </div>
                </div>
                <div class="task-list" id="filtered-tasks">
                    <!-- 过滤后的任务将通过JavaScript动态生成 -->
                </div>
            </div>

            <!-- 标签视图 -->
            <div class="view" id="tag-view" style="display: none;">
                <h2 id="tag-view-title">标签任务</h2>
                <div class="task-list" id="tag-tasks">
                    <!-- 标签相关任务将通过JavaScript动态生成 -->
                </div>
            </div>

            <!-- 标签管理模态框已移除 -->
        </div>
    </div>

    <!-- Socket.IO客户端库 -->
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>